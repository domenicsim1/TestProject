name: Package
on: [push]
jobs:
  Push-To-Ocotpus:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Install Octopus CLI üêô
        uses: OctopusDeploy/install-octopus-cli-action@v1.1.8
        with:
          version: latest
      - name: Create package
        run: >
          octo pack --id="TestProject" --version="1.0.2" --format=zip
      - name: Push a package to Octopus Deploy üêô
        uses: OctopusDeploy/push-package-action@v1.1.1
        with:
          version: latest
          api_key: ${{ secrets.API_KEY }}
          packages: 'TestProject.1.0.2.zip'
          server: ${{ secrets.SERVER }}
      - name: Generate Octopus Deploy build information
        uses: xo-energy/action-octopus-build-information@v1.0.0
        with:
          octopus_api_key: ${{ secrets.API_KEY }}
          octopus_server: ${{ secrets.SERVER }}
          octopus_project: TestProject
          output_path: octopus
          push_package_ids: TestProject
          push_version: ${{ github.ref }}